# [Recruit Restaurant Visitor Forecasting](https://www.kaggle.com/c/recruit-restaurant-visitor-forecasting)

## Problem Statement 
Running a thriving local restaurant isn't always as charming as first impressions appear. There are often all sorts of unexpected troubles popping up that could hurt business.

One common predicament is that restaurants need to know how many customers to expect each day to effectively purchase ingredients and schedule staff members. The daily number of customers affects all sorts of business decisions, including the quantity of perishable ingredients to purchase as well as how many staff members to schedule. If underestimated the number of customers, restaurants would run into shortages and customers would be unhappy. If overestimated, restaurant would have borne unnecessary costs. However, This forecast isn't easy to make because many unpredictable factors affect restaurant attendance, such as weather and local competition. It's even harder for newer restaurants with little historical data.

## Background
### How can Recruit Holdings help solve this challenege 
Recruit Holdings has access to several proprietary datasets that can be leveraged to make the process of customer count prediction easier. Specifically, Recruit Holdings owns 
- Hot Pepper Gourmet (a restaurant review service)
- AirREGI (a restaurant point of sales service)
- Restaurant Board (reservation log management software)

If successful, Recruit Holdings will be able to market that capability to not only retain existing customers/restaurants but also attract new ones. 

### Introduction of the dataset 
#### Brief Overview
![image](https://user-images.githubusercontent.com/76879882/117075674-dcbb5c80-acfa-11eb-92c3-942ca82f8275.png)
#### Some feature exploration 
- Most of the restaurants in the dataset are located in metropolises in Southern Japan
- On average customers make reservations 7-8 days in advanced, and reservations are made typically during lunch and dinner time on non-holidays 
- Tables are reserved mostly for Friday and Saturday 
- Reservation only accounts for a small fraction of total visits, hence it poses a great challenge for prediction 
![image](https://user-images.githubusercontent.com/76879882/117076174-99adb900-acfb-11eb-8f99-3ea7e29021de.png)


## Overall Process 
### Data generation 
The goal is to predict the number of visitors of Japanâ€™s restaurant starting from Apr 23rd to May 31st in 2017 (a total of 39 days starting from a Sunday and ending in a Wednesday), and we have training data ranging from Jan 1st, 2016 to Apr 22sd, 2017. Hence, this is a time-series prediction and the prediction label is 39 days with the start date as a Sunday and end date as Wednesday. Listed below is how the training data is generated. 
![image](https://user-images.githubusercontent.com/76879882/117077393-a206f380-acfd-11eb-9fc7-3afdf86f6748.png)

### Feature engineering 
A total of 407 features are generated and used. Most of the features are generated by taking their satistical aggregation such as min, max, mean, meidan, count, standard deviation, skew and kurtosis within different combinations such as store_id, day of week, is_not_holiday etc. To preserve the sequence in days, we also apply different weights in these statistical aggregations. 
#### Data size after feature engineering 
![image](https://user-images.githubusercontent.com/76879882/117078725-0f1b8880-ad00-11eb-9c41-63087fe9d09a.png)

### Model selection 
Lightgbm is selected over other models because it has great compatability with large datasets. Also, it has faster training speed and uses less memory by bucketing continuous features into discrete bins. In general, lightgbm has better accuracy than any other boosting algorithm because it produces much more complex trees by following leaf wise split approach rather than a level-wise approach adopted by other tree-based models. 

### Evaluation metric 








